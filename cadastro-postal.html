<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cafeteria Aconchego - Cadastro Postal</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="layout">
        <h1 class="text-4xl font-bold text-accent mb-8">Cadastro Postal</h1>
        <div class="max-w-2xl mx-auto">
            <div class="bg-card rounded-lg p-8 border border-border">
                <p class="text-muted-foreground mb-6">
                    Preencha o formulário abaixo com seu endereço. Digite o CEP para preenchimento automático.
                </p>

                <form id="form-cadastro-postal" class="space-y-6">
                    <div>
                        <label for="cep" class="block text-sm font-semibold mb-2">
                            CEP *
                        </label>
                        <input
                            type="text"
                            id="cep"
                            name="cep"
                            class="w-full px-4 py-2 border border-border rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-accent"
                            placeholder="00000-000"
                            maxlength="8"
                            required
                        />
                        <p class="text-xs text-muted-foreground mt-1">
                            Digite apenas números. Os dados serão preenchidos automaticamente.
                        </p>
                    </div>

                    <div>
                        <label for="rua" class="block text-sm font-semibold mb-2">
                            Rua *
                        </label>
                        <input
                            type="text"
                            id="rua"
                            name="rua"
                            class="w-full px-4 py-2 border border-border rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-accent"
                            placeholder="Nome da rua"
                            required
                        />
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="numero" class="block text-sm font-semibold mb-2">
                                Número *
                            </label>
                            <input
                                type="number"
                                id="numero"
                                name="numero"
                                class="w-full px-4 py-2 border border-border rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-accent"
                                placeholder="123"
                                required
                            />
                        </div>
                        <div>
                            <label for="complemento" class="block text-sm font-semibold mb-2">
                                Complemento
                            </label>
                            <input
                                type="text"
                                id="complemento"
                                name="complemento"
                                class="w-full px-4 py-2 border border-border rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-accent"
                                placeholder="Apto 456"
                            />
                        </div>
                    </div>

                    <div>
                        <label for="bairro" class="block text-sm font-semibold mb-2">
                            Bairro
                        </label>
                        <input
                            type="text"
                            id="bairro"
                            name="bairro"
                            class="w-full px-4 py-2 border border-border rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-accent"
                            placeholder="Nome do bairro"
                        />
                    </div>

                    <div class="grid grid-cols-3 gap-4">
                        <div class="col-span-2">
                            <label for="cidade" class="block text-sm font-semibold mb-2">
                                Cidade
                            </label>
                            <input
                                type="text"
                                id="cidade"
                                name="cidade"
                                class="w-full px-4 py-2 border border-border rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-accent"
                                placeholder="Nome da cidade"
                            />
                        </div>
                        <div>
                            <label for="estado" class="block text-sm font-semibold mb-2">
                                Estado
                            </label>
                            <input
                                type="text"
                                id="estado"
                                name="estado"
                                class="w-full px-4 py-2 border border-border rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-accent"
                                placeholder="SP"
                                maxlength="2"
                            />
                        </div>
                    </div>

                    <div class="flex gap-4 pt-4">
                        <button type="submit" class="flex-1 button bg-accent text-accent-foreground hover:bg-accent/90">
                            Cadastrar
                        </button>
                        <button
                            type="button"
                            id="btn-limpar"
                            class="flex-1 button variant-outline"
                        >
                            Limpar
                        </button>
                    </div>
                </form>

                <div id="mensagem-sucesso" class="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800 hidden">
                    Cadastro postal realizado com sucesso! Seus dados foram salvos.
                </div>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('form-cadastro-postal');
            const cepInput = document.getElementById('cep');
            const ruaInput = document.getElementById('rua');
            const bairroInput = document.getElementById('bairro');
            const cidadeInput = document.getElementById('cidade');
            const estadoInput = document.getElementById('estado');
            const btnLimpar = document.getElementById('btn-limpar');
            const mensagemSucesso = document.getElementById('mensagem-sucesso');

            const clearForm = () => {
                form.reset();
                mensagemSucesso.classList.add('hidden');
            };

            const preencherEndereco = (data) => {
                ruaInput.value = data.logradouro || '';
                bairroInput.value = data.bairro || '';
                cidadeInput.value = data.localidade || '';
                estadoInput.value = data.uf || '';
            };

            const buscarCEP = async (cep) => {
                cep = cep.replace(/\D/g, "");
                if (cep.length !== 8) return;

                try {
                    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                    const data = await response.json();

                    if (!data.erro) {
                        preencherEndereco(data);
                        alert("CEP encontrado!");
                    } else {
                        alert("CEP não encontrado.");
                        clearForm();
                    }
                } catch (error) {
                    alert("Erro ao buscar CEP.");
                }
            };

            cepInput.addEventListener('blur', (e) => {
                buscarCEP(e.target.value);
            });

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // Simulação de validação e salvamento
                if (!cepInput.value || !ruaInput.value || !document.getElementById('numero').value) {
                    alert("Por favor, preencha todos os campos obrigatórios (CEP, Rua, Número).");
                    return;
                }

                // Simulação de salvamento no localStorage
                const formData = {
                    cep: cepInput.value,
                    rua: ruaInput.value,
                    numero: document.getElementById('numero').value,
                    complemento: document.getElementById('complemento').value,
                    bairro: bairroInput.value,
                    cidade: cidadeInput.value,
                    estado: estadoInput.value,
                    id: Date.now()
                };

                const cadastros = JSON.parse(localStorage.getItem("cadastrosPostais") || "[]");
                cadastros.push(formData);
                localStorage.setItem("cadastrosPostais", JSON.stringify(cadastros));

                // Exibir mensagem de sucesso
                mensagemSucesso.classList.remove('hidden');
                form.reset();
                
                setTimeout(() => {
                    mensagemSucesso.classList.add('hidden');
                }, 3000);
            });

            btnLimpar.addEventListener('click', clearForm);
        });
    </script>
</body>
</html>
